<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trợ lý Tích hợp Năng lực số</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'cream': '#FDF8F0',
                        'light-yellow': '#F2CC8F',
                        'light-green': '#81B29A',
                        'dark-blue': '#3D405B',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-cream font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const App = () => {
            const [subject, setSubject] = React.useState('');
            const [grades, setGrades] = React.useState([]);
            const [appendix1, setAppendix1] = React.useState(false);
            const [appendix3, setAppendix3] = React.useState(false);
            const [fileName, setFileName] = React.useState('');

            const [prompt1, setPrompt1] = React.useState('');
            const [prompt3, setPrompt3] = React.useState('');
            
            const [showResults, setShowResults] = React.useState(false);
            const resultsRef = React.useRef(null);

            const handleGradeChange = (grade) => {
                setGrades(prev => 
                    prev.includes(grade) 
                        ? prev.filter(g => g !== grade) 
                        : [...prev, grade].sort((a,b) => a-b)
                );
            };

            const handleGenerate = () => {
                if (!subject || grades.length === 0 || (!appendix1 && !appendix3) || !fileName) {
                    alert('Vui lòng nhập đầy đủ thông tin: Môn học, Khối lớp, chọn ít nhất một Phụ lục và tải lên file KHDH.');
                    return;
                }

                const selectedGrades = grades.join(', ');

                if (appendix1) {
                    const p1 = `Tạo **PHỤ LỤC 1: TÍCH HỢP NĂNG LỰC SỐ VÀO KẾ HOẠCH DẠY HỌC (Dành cho Tổ chuyên môn)**

**Bối cảnh:**
Bạn là chuyên gia giáo dục Việt Nam, am hiểu sâu sắc Chương trình GDPT 2018. Nhiệm vụ của bạn là hỗ trợ Tổ chuyên môn môn **\`${subject}\`** xây dựng một phụ lục tích hợp Năng lực số (NLS), trong đó **diễn giải chi tiết** hoạt động thực tế để hình thành NLS cho học sinh khối **\`${selectedGrades}\`**.

**Tài liệu nguồn (BẮT BUỘC):**
1.  **\`Thông tư 02/2025/TT-BGDĐT\` (Khung NLS):** Tài liệu gốc để hiểu bản chất của từng năng lực.
2.  **\`Công văn 405/SGDĐT-GDTrH Quảng Ngãi\`:** Đây là tài liệu định hướng để xác định **MỨC ĐỘ** năng lực phù hợp cho từng khối lớp, được quy định rõ trong Phụ lục đính kèm Công văn 405. Cụ thể:
    *   **Lớp 1, 2:** Ưu tiên mức **"Cơ bản 1"** (tương ứng cột L1-L2).
    *   **Lớp 3, 4, 5:** Ưu tiên mức **"Cơ bản 2"** (tương ứng cột L3-L4-L5).
    *   **Lớp 6, 7:** Ưu tiên mức **"Trung cấp 1"** (tương ứng cột L6-L7).
    *   **Lớp 8, 9:** Ưu tiên mức **"Trung cấp 2"** (tương ứng cột L8-L9).
    *   **Lớp 10, 11, 12:** Ưu tiên mức **"Nâng cao 1"** (tương ứng cột L10-L11-L12).
    *   *Lưu ý: Có thể linh hoạt sử dụng mức độ cao hơn nếu nội dung bài học đòi hỏi.*
3.  **\`${fileName}\` (Kế hoạch dạy học đính kèm):** Tài liệu chính để phân tích nội dung bài học.

**Yêu cầu chi tiết về quy trình (CỰC KỲ QUAN TRỌNG):**

1.  **Phân tích KHDH:** Từ file **\`${fileName}\`**, xác định các tiết học (PP) phù hợp để tích hợp NLS.
2.  **Xác định NLS và CHỈ BÁO:**
    *   Với mỗi tiết học đã chọn, tìm đến Năng lực thành phần tương ứng trong Thông tư 02 (ví dụ: 1.1).
    *   Dựa vào định hướng mức độ cho khối **\`${selectedGrades}\`** từ Công văn 405, xác định đúng cột mức độ trong bảng mô tả của Thông tư 02.
    *   Trong cột đó, có nhiều **chỉ báo được đánh dấu bằng gạch đầu dòng (-)**. Bạn phải **chọn ra MỘT chỉ báo (một gạch đầu dòng)** cụ thể, phù hợp nhất với hoạt động dạy học.
3.  **DIỄN GIẢI HOẠT ĐỘNG THỰC TẾ:**
    *   Đây là yêu cầu then chốt. Dựa trên chỉ báo đã chọn, hãy **diễn giải nó thành một hoạt động học tập cụ thể, sinh động, gắn chặt với bài học của tiết đó**.
    *   **Ví dụ (Lớp 6):** Nếu chọn chỉ báo "- Giải thích được nhu cầu thông tin" cho bài "Chạy cự li ngắn", bạn phải diễn giải thành: **"TC 1.1.a: HS được giao nhiệm vụ tìm kiếm video về 'kỹ thuật chạy giữa quãng 60m' để hiểu rõ hơn về cách duy trì tốc độ."**
4.  **Trình bày kết quả:**
    *   Ghi kết quả vào bảng theo định dạng yêu cầu.
    *   Phần "Năng lực số hình thành" phải bắt đầu bằng mã viết tắt (CB, TC, NC, CS) + mã năng lực + ký hiệu chỉ báo (a,b,c...), theo sau là phần diễn giải thực tế.

**Định dạng đầu ra:**

**PHỤ LỤC 1: TÍCH HỢP NĂNG LỰC SỐ VÀO KẾ HOẠCH DẠY HỌC MÔN \`${subject}\` - KHỐI \`${selectedGrades}\`**
*(Phiên bản diễn giải chi tiết cho Tổ chuyên môn)*

| Tiết PP | Chủ đề/Bài học | Năng lực số hình thành |
| :--- | :--- | :--- |
| *(Dữ liệu do bạn tạo ra)* |

**Lưu ý:**
File Kế hoạch dạy học đính kèm có tên là **\`${fileName}\`**. Hãy xác nhận đã nhận và phân tích được file này trước khi bắt đầu.`;
                    setPrompt1(p1);
                } else {
                    setPrompt1('');
                }

                if (appendix3) {
                    const p3 = `Tạo **PHỤ LỤC 3: NĂNG LỰC SỐ CẦN HÌNH THÀNH TRONG MÔN HỌC (Dành cho Kế hoạch giáo dục của giáo viên)**

**Bối cảnh:**
Bạn là chuyên gia giáo dục Việt Nam. Nhiệm vụ của bạn là hỗ trợ tôi, một giáo viên môn **\`${subject}\`**, xây dựng một phụ lục đính kèm Kế hoạch giáo dục cá nhân. Phụ lục này cần **trích dẫn nguyên văn và chính xác tuyệt đối** các chỉ báo năng lực số (NLS) được hình thành trong năm học.

**Tài liệu nguồn (BẮT BUỘC):**
1.  **\`Thông tư 02/2025/TT-BGDĐT\` (Khung NLS):** Tài liệu gốc để tra cứu và **sao chép nguyên văn** mô tả của từng chỉ báo.
2.  **\`Công văn 405/SGDĐT-GDTrH Quảng Ngãi\`:** Đây là tài liệu định hướng để xác định **MỨC ĐỘ** năng lực phù hợp cho từng khối lớp, được quy định rõ trong Phụ lục đính kèm Công văn 405. Cụ thể:
    *   **Lớp 1, 2:** Ưu tiên mức **"Cơ bản 1"** (tương ứng cột L1-L2).
    *   **Lớp 3, 4, 5:** Ưu tiên mức **"Cơ bản 2"** (tương ứng cột L3-L4-L5).
    *   **Lớp 6, 7:** Ưu tiên mức **"Trung cấp 1"** (tương ứng cột L6-L7).
    *   **Lớp 8, 9:** Ưu tiên mức **"Trung cấp 2"** (tương ứng cột L8-L9).
    *   **Lớp 10, 11, 12:** Ưu tiên mức **"Nâng cao 1"** (tương ứng cột L10-L11-L12).
3.  **\`${fileName}\` (Kế hoạch dạy học đính kèm):** Tài liệu chính để phân tích nội dung bài học.

**Yêu cầu chi tiết về quy trình (CỰC KỲ QUAN TRỌNG):**

1.  **Phân tích KHDH:** Từ file **\`${fileName}\`**, xác định các tiết học (PP) phù hợp để tích hợp NLS.
2.  **Xác định NLS và CHỈ BÁO:**
    *   Với mỗi tiết học đã chọn, tìm đến Năng lực thành phần tương ứng trong Thông tư 02 (ví dụ: 1.1).
    *   Dựa vào định hướng mức độ cho khối **\`${selectedGrades}\`** từ Công văn 405, xác định đúng cột mức độ trong bảng mô tả của Thông tư 02.
    *   Trong cột đó, bạn phải **chọn ra MỘT chỉ báo (nội dung của một gạch đầu dòng "-")** cụ thể, phù hợp nhất với hoạt động dạy học.
3.  **TRÍCH DẪN NGUYÊN VĂN:**
    *   Đây là yêu cầu then chốt. Bạn phải **sao chép chính xác từng từ** của chỉ báo đã chọn từ Thông tư 02 vào bảng kết quả. **TUYỆT ĐỐI KHÔNG** diễn giải, tóm tắt hay thay đổi bất kỳ từ ngữ nào.
4.  **Trình bày kết quả:**
    *   Ghi kết quả vào bảng theo định dạng yêu cầu.
    *   Phần "Năng lực số hình thành" phải bắt đầu bằng mã viết tắt (CB, TC, NC, CS) + mã năng lực + ký hiệu chỉ báo (a,b,c...), theo sau là phần mô tả được sao chép nguyên văn.

**Định dạng đầu ra:**

**PHỤ LỤC 3: NĂNG LỰC SỐ CẦN HÌNH THÀNH TRONG MÔN \`${subject}\` - KHỐI \`${selectedGrades}\`**
*(Phiên bản trích dẫn nguyên văn theo Thông tư)*

| Tiết PP | Chủ đề/Bài học | Năng lực số hình thành |
| :--- | :--- | :--- |
| *(Dữ liệu do bạn tạo ra. Ví dụ: "TC 1.1.a: Giải thích được nhu cầu thông tin.")* |

**Lưu ý:**
File Kế hoạch dạy học đính kèm có tên là **\`${fileName}\`**. Hãy xác nhận đã nhận và phân tích được file này trước khi bắt đầu.`;
                    setPrompt3(p3);
                } else {
                    setPrompt3('');
                }
                setShowResults(true);
                setTimeout(() => {
                    resultsRef.current?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            };

            const copyToClipboard = (text, id) => {
                navigator.clipboard.writeText(text).then(() => {
                    const button = document.getElementById(id);
                    if(!button) return;
                    const originalText = button.innerHTML;
                    button.innerHTML = `Đã chép!`;
                    button.classList.add('bg-light-green', 'text-black');
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.classList.remove('bg-light-green', 'text-black');
                    }, 2000);
                }, (err) => {
                    alert('Không thể sao chép!');
                });
            };
            
            const copyAll = () => {
                const allPrompts = [];
                if(prompt1) allPrompts.push("---\nPROMPT PHỤ LỤC 1 ---\n" + prompt1);
                if(prompt3) allPrompts.push("---\nPROMPT PHỤ LỤC 3 ---\n" + prompt3);
                copyToClipboard(allPrompts.join('\n\n'), 'copy-btn-all');
            }

            const gradeOptions = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];

            const BrutalButton = ({ children, onClick, id, className = '' }) => (
                <button 
                    id={id}
                    onClick={onClick}
                    className={`p-2 bg-white border-2 border-black font-bold shadow-[4px_4px_0px_#000000] hover:shadow-none active:shadow-none hover:translate-x-1 hover:translate-y-1 transition-all ${className}`}>
                    {children}
                </button>
            );

            return (
                <div className="min-h-screen">
                    <div className="container mx-auto p-4 sm:p-6 md:p-8 max-w-5xl">
                        <header className="text-center mb-12">
                            <h1 className="text-5xl sm:text-6xl font-extrabold text-black mb-4">
                                Trợ lý Năng lực số
                            </h1>
                            <p className="text-dark-blue mt-2 text-xl">Tạo prompt tích hợp NLS cho kế hoạch dạy học.</p>
                            <div className="mt-6 flex flex-wrap justify-center items-center gap-4">
                                <a 
                                    href="https://kontum01-my.sharepoint.com/:f:/g/personal/quanth_c12sb_st_gdkontum_edu_vn/EuuHrh0ngWZEjhwtFRLyUa0B8pu7N9edZhyJvIy8Skh4SA?e=4fxnRr"
                                    target="_blank" 
                                    rel="noopener noreferrer"
                                    className="inline-block p-2 bg-light-green border-2 border-black font-bold shadow-[4px_4px_0px_#000000] hover:shadow-none active:shadow-none hover:translate-x-1 hover:translate-y-1 transition-all"
                                >
                                    Tải Tài liệu
                                </a>
                                <a 
                                    href="https://ung-ho-tac-gia.netlify.app/"
                                    target="_blank" 
                                    rel="noopener noreferrer"
                                    className="inline-block p-2 bg-light-yellow border-2 border-black font-bold shadow-[4px_4px_0px_#000000] hover:shadow-none active:shadow-none hover:translate-x-1 hover:translate-y-1 transition-all"
                                >
                                    Donate
                                </a>
                                <a 
                                    href="#video-guide"
                                    onClick={(e) => {
                                        e.preventDefault();
                                        document.getElementById('video-guide')?.scrollIntoView({ behavior: 'smooth' });
                                    }}
                                    className="inline-block p-2 bg-dark-blue text-white border-2 border-black font-bold shadow-[4px_4px_0px_#000000] hover:shadow-none active:shadow-none hover:translate-x-1 hover:translate-y-1 transition-all"
                                >
                                    Video Hướng dẫn
                                </a>
                            </div>
                        </header>

                        <div className="bg-white border-2 border-black rounded-xl shadow-[8px_8px_0px_#000000] p-6 sm:p-8 mb-12">
                            <h2 className="text-3xl font-bold mb-6 text-black flex items-center">
                                <span className="bg-light-yellow text-black border-2 border-black rounded-full h-10 w-10 flex items-center justify-center mr-4 font-mono text-xl">1</span>
                                Thông tin
                            </h2>
                            
                            <div className="space-y-6">
                                <div>
                                    <label htmlFor="subject" className="block text-lg font-bold text-black mb-2">Tên môn học</label>
                                    <input 
                                        type="text" 
                                        id="subject"
                                        value={subject}
                                        onChange={(e) => setSubject(e.target.value)}
                                        className="w-full p-3 bg-cream border-2 border-black rounded-lg text-lg focus:ring-0 focus:border-black focus:bg-white transition"
                                        placeholder="VD: giáo dục thể chất"
                                    />
                                </div>

                                <div>
                                    <label className="block text-lg font-bold text-black mb-2">Khối lớp</label>
                                    <div className="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-6 gap-2">
                                        {gradeOptions.map(grade => (
                                            <label key={grade} className={`flex items-center justify-center p-3 border-2 border-black rounded-lg cursor-pointer transition-all duration-200 font-bold ${grades.includes(grade) ? 'bg-black text-white' : 'bg-white hover:bg-light-yellow'}`}>
                                                <input type="checkbox" checked={grades.includes(grade)} onChange={() => handleGradeChange(grade)} className="sr-only"/>
                                                <span>{grade}</span>
                                            </label>
                                        ))}
                                    </div>
                                </div>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 items-center pt-2">
                                    <div>
                                        <label className="block text-lg font-bold text-black mb-2">Chọn Phụ lục</label>
                                        <div className="flex items-center space-x-6">
                                            <label className="flex items-center space-x-3 cursor-pointer">
                                                <input type="checkbox" checked={appendix1} onChange={() => setAppendix1(!appendix1)} className="h-6 w-6 text-black border-2 border-black rounded-md focus:ring-0 bg-cream" />
                                                <span className="text-lg font-medium text-black">Phụ lục 1</span>
                                            </label>
                                            <label className="flex items-center space-x-3 cursor-pointer">
                                                <input type="checkbox" checked={appendix3} onChange={() => setAppendix3(!appendix3)} className="h-6 w-6 text-black border-2 border-black rounded-md focus:ring-0 bg-cream" />
                                                <span className="text-lg font-medium text-black">Phụ lục 3</span>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    {(appendix1 || appendix3) && (
                                        <div>
                                            <label htmlFor="file-upload" className="relative cursor-pointer bg-white p-3 border-2 border-black rounded-lg flex items-center justify-center font-bold shadow-[4px_4px_0px_#000000] hover:shadow-none active:shadow-none hover:translate-x-1 hover:translate-y-1 transition-all">
                                                <span className={`${fileName ? 'text-light-green' : 'text-black'}`}>{fileName ? `Đã chọn: ${fileName}` : 'Chọn file KHDH...'}</span>
                                                <input id="file-upload" type="file" className="sr-only" onChange={(e) => setFileName(e.target.files[0] ? e.target.files[0].name : '')} />
                                            </label>
                                        </div>
                                    )}
                                </div>
                            </div>

                            <div className="mt-10 border-t-2 border-black pt-6 text-center">
                                <button 
                                    onClick={handleGenerate}
                                    className="w-full sm:w-auto px-12 py-4 border-2 border-black text-xl font-bold rounded-lg text-black bg-light-yellow shadow-[6px_6px_0px_#000000] hover:shadow-none active:shadow-none hover:translate-x-1.5 hover:translate-y-1.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-300 disabled:shadow-none disabled:translate-x-0 disabled:translate-y-0"
                                    disabled={!subject || grades.length === 0 || (!appendix1 && !appendix3) || !fileName}
                                >
                                    Tạo câu lệnh
                                </button>
                            </div>
                        </div>

                        {showResults && (
                            <div ref={resultsRef} className="bg-white border-2 border-black rounded-xl shadow-[8px_8px_0px_#000000] p-6 sm:p-8 mb-12">
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-3xl font-bold text-black flex items-center">
                                        <span className="bg-light-green text-black border-2 border-black rounded-full h-10 w-10 flex items-center justify-center mr-4 font-mono text-xl">2</span>
                                        Kết quả
                                    </h2>
                                    {(prompt1 && prompt3) && (
                                        <BrutalButton id="copy-btn-all" onClick={copyAll} className="bg-light-yellow">Sao chép tất cả</BrutalButton>
                                    )}
                                </div>

                                {prompt1 && (
                                    <div className="mb-6">
                                        <h3 className="text-xl font-bold text-black mb-3">Prompt cho Phụ lục 1</h3>
                                        <div className="relative group">
                                            <pre className="whitespace-pre-wrap text-base text-gray-200 bg-dark-blue p-4 rounded-lg max-h-72 overflow-y-auto font-mono border-2 border-black">{prompt1}</pre>
                                            <BrutalButton id="copy-btn-1" onClick={() => copyToClipboard(prompt1, 'copy-btn-1')} className="absolute top-3 right-3 text-sm !py-1 !px-2 bg-light-yellow opacity-0 group-hover:opacity-100">Sao chép</BrutalButton>
                                        </div>
                                    </div>
                                )}
                                {prompt3 && (
                                    <div>
                                        <h3 className="text-xl font-bold text-black mb-3">Prompt cho Phụ lục 3</h3>
                                        <div className="relative group">
                                            <pre className="whitespace-pre-wrap text-base text-gray-200 bg-dark-blue p-4 rounded-lg max-h-72 overflow-y-auto font-mono border-2 border-black">{prompt3}</pre>
                                            <BrutalButton id="copy-btn-3" onClick={() => copyToClipboard(prompt3, 'copy-btn-3')} className="absolute top-3 right-3 text-sm !py-1 !px-2 bg-light-yellow opacity-0 group-hover:opacity-100">Sao chép</BrutalButton>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        <div className="bg-white border-2 border-black rounded-xl shadow-[8px_8px_0px_#000000] p-6 sm:p-8">
                             <h2 className="text-3xl font-bold mb-6 text-black flex items-center">
                                <span className="bg-dark-blue text-white border-2 border-black rounded-full h-10 w-10 flex items-center justify-center mr-4 font-mono text-xl">3</span>
                                Hướng dẫn
                            </h2>
                            <div className="grid md:grid-cols-2 gap-8 text-black">
                                <div className="space-y-3 text-lg">
                                    <h3 className="font-extrabold text-xl mb-2">Các bước thực hiện</h3>
                                    <p>1. Nhập Tên môn học và chọn Khối lớp.</p>
                                    <p>2. Chọn Phụ lục 1 và/hoặc Phụ lục 3.</p>
                                    <p>3. Nhấn để chọn file Kế hoạch dạy học.</p>
                                    <p>4. Nhấn nút "Tạo câu lệnh" và xem kết quả.</p>
                                </div>
                                <div className="space-y-3 text-lg">
                                    <h3 className="font-extrabold text-xl mb-2">Sử dụng với AI</h3>
                                    <p>1. Nhấn nút "Sao chép" ở mục kết quả.</p>
                                    <p>2. Mở AI (ChatGPT, Gemini...), dán prompt vào.</p>
                                    <p>3. Đính kèm file Kế hoạch dạy học và gửi đi.</p>
                                </div>
                            </div>
                        </div>

                        <div id="video-guide" className="bg-white border-2 border-black rounded-xl shadow-[8px_8px_0px_#000000] p-6 sm:p-8 mt-12">
                             <h2 className="text-3xl font-bold mb-6 text-black flex items-center">
                                <span className="bg-light-yellow text-black border-2 border-black rounded-full h-10 w-10 flex items-center justify-center mr-4 font-mono text-xl">4</span>
                                Video Hướng dẫn
                            </h2>
                            <div className="rounded-lg overflow-hidden border-2 border-black">
                                <iframe 
                                    className="w-full h-[560px]"
                                    src="https://www.youtube.com/embed/iHMYNYoPcPA" 
                                    title="YouTube video player" 
                                    frameBorder="0" 
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                                    allowFullScreen>
                                </iframe>
                            </div>
                        </div>
                        
                        <footer className="text-center mt-12 text-dark-blue text-sm">
                            <p>Phát triển bởi Gemini - Google AI. Dự án phi lợi nhuận hỗ trợ giáo viên.</p>
                        </footer>
                    </div>
                </div>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>